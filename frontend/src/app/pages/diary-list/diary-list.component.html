<div class="diary-container">
  <h1>Meu Diário</h1>

  <div class="form-container">
    <h2>Nova Entrada</h2>
    <form [formGroup]="newEntryForm" (ngSubmit)="onSubmitNewEntry()">
      <textarea formControlName="conteudo" placeholder="No que você está pensando?" rows="5"></textarea>
      <div class="form-row">
        <div class="form-group mood-selector">
          <label>Humor:</label>
          <div class="mood-pills">
            <button type="button" class="pill" [class.active]="newEntryForm.get('humor')?.value===1" (click)="newEntryForm.get('humor')?.setValue(1)">1</button>
            <button type="button" class="pill" [class.active]="newEntryForm.get('humor')?.value===2" (click)="newEntryForm.get('humor')?.setValue(2)">2</button>
            <button type="button" class="pill" [class.active]="newEntryForm.get('humor')?.value===3" (click)="newEntryForm.get('humor')?.setValue(3)">3</button>
            <button type="button" class="pill" [class.active]="newEntryForm.get('humor')?.value===4" (click)="newEntryForm.get('humor')?.setValue(4)">4</button>
            <button type="button" class="pill" [class.active]="newEntryForm.get('humor')?.value===5" (click)="newEntryForm.get('humor')?.setValue(5)">5</button>
          </div>
        </div>
        <div class="form-group draft-selector">
          <label><input type="checkbox" formControlName="rascunho"> Salvar como rascunho</label>
        </div>
      </div>
      <button class="btn" type="submit" [disabled]="newEntryForm.invalid">Salvar Entrada</button>
    </form>
  </div>

  <div class="search-container">
    <h2>Buscar Entradas</h2>
    <form [formGroup]="searchForm" (ngSubmit)="onSearch()">
      <div class="form-row">
        <input type="text" formControlName="palavraChave" placeholder="Buscar por palavra-chave...">
        <input type="date" formControlName="data">
        <button class="btn" type="submit">Buscar</button>
        <button class="btn btn-outline" type="button" (click)="clearSearch()">Limpar</button>
      </div>
    </form>
  </div>

  <div class="entries-list">
    <h2>Entradas Anteriores</h2>
    <div *ngIf="entries.length === 0" class="no-entries">
      <p>Nenhuma entrada encontrada. Que tal criar a primeira?</p>
    </div>
    <div *ngFor="let entry of entries" class="entry-card">
      <div class="entry-header">
        <span class="entry-date">{{ entry.dataCriacao | date:'dd/MM/yyyy HH:mm' }}</span>
        <span class="entry-mood" *ngIf="entry.humor">Humor: {{ entry.humor }} / 5</span>
        <span class="entry-draft" *ngIf="entry.rascunho">(Rascunho)</span>
      </div>
      <div class="entry-content"><p [innerHTML]="highlightContent(entry.conteudo)"></p></div>
    </div>
  </div>
</div>